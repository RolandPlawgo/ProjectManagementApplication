@using ProjectManagementApplication.Authentication;
@using Microsoft.AspNetCore.Identity;
@inject UserManager<ApplicationUser> userManager;
@model List<ProjectManagementApplication.Authentication.ApplicationUser>;
@{
	ViewData["Title"] = "Users";
	int currentPage = ViewBag.CurrentPage as int? ?? 1;
	int totalPages = ViewBag.TotalPages as int? ?? 1;
}

<h1 class="h2">Users</h1>

<table class="table">
	<thead>
		<tr>
			<th>E-mail</th>
			<th>First Name</th>
			<th>Last Name</th>
			<th>Role</th>
			<th></th>
			<th></th>
		</tr>
	</thead>
	<tbody>
		@foreach (var user in Model)
		{
			<tr>
				<td>@user.Email</td>
				<td>@user.FirstName</td>
				<td>@user.LastName</td>
				<td>@((await userManager.GetRolesAsync(user)).FirstOrDefault())</td>
				<td><a asp-action="Edit" asp-route-id="@user.Id" class="btn btn-outline-primary">edit</a></td>
				<td>
					<form asp-action="Delete" asp-route-id="@user.Id">
						<button type="submit" class="btn btn-outline-danger">delete</button>
					</form>
				</td>
			</tr>
		}
	</tbody>
</table>

<div class="container">
	<div class="row">
		<a asp-action="Create" class="btn btn-primary col-1">Add user</a>
	</div>
</div>

<nav aria-label="Page navigation">
	<ul class="pagination justify-content-end">
		<li class="page-item @(currentPage == 1 ? "disabled" : "")">
			<a class="page-link" asp-action="Index" asp-route-page="@(currentPage - 1)">Previous</a>
		</li>

		@for (int i = 1; i <= totalPages; i++)
		{
			<li class="page-item @(i == currentPage ? "active" : "")">
				<a class="page-link" asp-action="Index" asp-route-page="@i">@i</a>
			</li>
		}

		<li class="page-item @(currentPage == totalPages ? "disabled" : "")">
			<a class="page-link" asp-action="Index" asp-route-page="@(currentPage + 1)">Next</a>
		</li>
	</ul>
</nav>